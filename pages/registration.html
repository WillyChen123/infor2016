<!--
	Hyperspace by HTML5 UP
	html5up.net | @n33co
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>ZSISC x INFOR</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
	   	<link rel="stylesheet" href="assets/css/main.css" />
        <link rel="Shortcut Icon" type="image/x-icon" href="images/favicon.ico"/>
		<!--[if lte IE 9]><link rel="stylesheet" href="assets/css/ie9.css" /><![endif]-->
		<!--[if lte IE 8]><link rel="stylesheet" href="assets/css/ie8.css" /><![endif]-->
		<link href="https://cdn.rawgit.com/noelboss/featherlight/1.4.0/release/featherlight.min.css" type="text/css" rel="stylesheet" />
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-beta1/jquery.min.js" type="text/javascript" ></script>
		<script src="https://cdn.rawgit.com/noelboss/featherlight/1.4.0/release/featherlight.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="/assets/dist/sweetalert.min.js"></script>
		<link rel="stylesheet" type="text/css" href="/assets/dist/sweetalert.css">
	</head>
	<body>

		<!-- Header -->
			<header id="header">
				<a href="/" class="title">ZSISC x INFOR</a>
				<nav>
					<ul>
						<li><a href="/about">About</a></li>
						<li><a href="/registration" class="active">Registration</a></li>
					</ul>
				</nav>
			</header>

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
                <section id="main" class="wrapper">
                    <div class="inner">
                    <h1>報名</h1>
                    <form method="post" action="#">
                        <div class="row uniform">
                            <div class="6u 12u$(xsmall)">
                                <input type="text" name="demo-name" class="plac" id="name" value="" placeholder="社團名稱" />
                            </div>
                            <div class="3u 6u(xsmall)">
                                <input type="email" name="demo-email" class="plac" id="roomm" value="" placeholder="住宿人數(男)" />
                            </div>
                            <div class="3u$ 6u$(xsmall)">
                                <input type="email" name="demo-email" class="plac" id="roomf" value="" placeholder="住宿人數(女)" />
                            </div>
 
                            <div class="6u 12u$(xsmall)">
                                <div class="select-wrapper">
                                    <select name="demo-category" id="join">
                                        <option value="-1">參加</option>
                                        <option value="0">楓資&amp;&amp;建資茶會</option>
                                        <option value="1">楓資茶會</option>
                                        <option value="2">建資茶會</option>
                                    </select>
                                </div>
                            </div>
                            <div class="6u$ 12u$(xsmall)">
                                <div class="select-wrapper">
                                    <select name="demo-category" id="locate">
                                        <option value="-1">集合地點</option>
                                        <option value="0">台北車站(5/28 12:30)</option>
                                        <option value="1">捷運松江南京四號出口(5/28 12:35)</option>
                                        <option value="2">中山女高校門口(5/28 12:45)</option>
                                        <option value="3">台北車站南二門(5/29 9:10)</option>
                                        <option value="4">捷運中正紀念堂站二號出口(5/29 9:20)</option>
                                        <option value="5">建國中學校門口(5/29 9:30)</option>
                                    </select>
                                </div>
                            </div>

                            <div class="6u$ 12u$(xsmall)">
                                <input type="checkbox" id="night" name="night">
                                <label for="night">參加夜遊</label>
                            </div>

                            <div class="12u$ personappend">
                                <textarea name="demo-message" class="plac" id="ps" placeholder="備註" rows="6"></textarea>
                            </div>
                            <div class="12u$">
                                <ul class="actions">
                                    <li><input type="button" value="Register" class="special" id="regist"/></li>
                                    <li><input type="reset" value="Reset" id="reset"/></li>
                                </ul>
                            </div>
                        </div>
                    </form>
                    </div>
                </section>

			</div>

		<!-- Footer -->
			<footer id="footer" class="wrapper alt">
				<div class="inner">
					<ul class="menu">
						<li>&copy; <a href="http://infor.org/">INFOR</a>. <a href="https://www.facebook.com/%E4%B8%AD%E5%B1%B1%E5%A5%B3%E9%AB%98%E8%B3%87%E8%A8%8A%E7%A0%94%E7%A9%B6%E7%A4%BE23rd-22    7240130967095/?fref=ts">ZSISC</a>. All rights reserved.</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
					</ul>
				</div>
			</footer>

		<!-- Scripts -->
			<script src="../assets/js/jquery.min.js"></script>
			<script src="../assets/js/jquery.scrollex.min.js"></script>
			<script src="../assets/js/jquery.scrolly.min.js"></script>
			<script src="../assets/js/skel.min.js"></script>
			<script src="../assets/js/util.js"></script>
			<!--[if lte IE 8]><script src="../assets/js/ie/respond.min.js"></script><![endif]-->
			<script src="../assets/js/main.js"></script>
	</body>
</html>

<script src="/socket.io/socket.io.js"></script>

<script>
	var socket=io();
    var cnt=0;
    var appe=[];
    $('.personappend').before('<div class="6u 12u$(xsmall)"><input type="text" name="demo-message" class="appendname" id="person'+cnt+'" placeholder="姓名（中山有入校限制）" rows="1"></input></div>');
    appe.push(0);

    setInterval(function(){
        if(document.getElementById('person'+cnt).value!=""){
            cnt++;
            $('.personappend').before('<div class="6u 12u$(xsmall)"><input type="text" name="demo-message" class="appendname" id="person'+cnt+'" placeholder="姓名" rows="1"></input></div>');
            appe.push(cnt);
        }
        for(i=0;i<appe.length-1;i++){
            if(appe[i]!=undefined&&document.getElementById('person'+appe[i]).value==""&&appe.length>1){
                $('#person'+appe[i]).parent().remove();
                delete appe[i];
            }
        }
    },50)

    $(document).keydown(function (e) {
       if (e.which == 8 && !(e.target.type == "text" || e.target.type == "textarea")) 
           e.preventDefault();
    });

	window.addEventListener('load',function(){
		document.getElementById('regist').addEventListener('click',function(){
			var name=document.getElementById('name').value;
			var roomm=document.getElementById('roomm').value;
			var roomf=document.getElementById('roomf').value;
			var join=document.getElementById('join').value;
			var locate=document.getElementById('locate').value;

            var able=true;

            var person=[];
            for(i=0;i<appe.length-1;i++){
                if(appe[i]!=undefined){
                    person.push(document.getElementById('person'+appe[i]).value);
                }
            }

            var ps=document.getElementById('ps').value;
            var night=document.getElementById('night').checked;

			if(join==="-1"){
				join="NO";
			}
			else if(join==="1"){
				join="ZSISC";
			}
			else if(join==="2"){
				join="INFOR";
			}
			else if(join==="0"){
				join="BOTH";
			}
			else{
				join="there's a bug";
			}
            if(locate==="-1"){
				locate="NO";
			}
			else if(locate==="1"){
				locate="Taipei main station 5/28";
			}
			else if(locate==="2"){
				locate="MRT 5/28";
			}
			else if(locate==="0"){
				locate="School 5/28";
			}
			else if(locate==="3"){
				locate="Taipeiain station 5/29";
			}
			else if(locate==="4"){
				locate="MRT 5/29";
			}
			else if(locate==="5"){
				locate="School 5/29";
			}
			else{
				locate="there's a bug";
			}

            if(name==""||roomm==""||roomf==""||join=="NO"||person.length==0){
            	able=false;
            }
			if(able){
				socket.emit("sendReg", name, roomm, roomf, join, person, ps, night, locate);
			}
			else{
				sweetAlert("Oops...","看起來有空格","error");
			}
		})
		document.getElementById('reset').addEventListener('click',function(){
			document.getElementById('name').value="";
			document.getElementById('room').value="";
			document.getElementById('join').value="-1";
			document.getElementById('locate').value="-1";

            for(i=0;i<appe.length-1;i++){
                document.getElementById('person'+appe[i]).value="";
            }/*
            if press_reset
                then get_ERROR
            working
            */

            document.getElementById('ps').value="";
            document.getElementById('night').value="";
		})
	})

    socket.on('done',function(){
       swal({   title: "success",  type: "success",   confirmButtonColor: "#8CD4F5",   confirmButtonText: "Back to Home",   closeOnConfirm: false }, function(){   window.location.href = "/" });
    })
    socket.on('regfailed',function(){
        sweetAlert("Oops...","Something went wrong!","error");
    })
</script>

<!--
	bugs: human checkbox

-->
