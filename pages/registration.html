<!--
	Hyperspace by HTML5 UP
	html5up.net | @n33co
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>建楓茶會</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<!--[if lte IE 8]><script src="assets/js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="assets/css/main.css" />
		<!--[if lte IE 9]><link rel="stylesheet" href="assets/css/ie9.css" /><![endif]-->
		<!--[if lte IE 8]><link rel="stylesheet" href="assets/css/ie8.css" /><![endif]-->
		<link href="https://cdn.rawgit.com/noelboss/featherlight/1.4.0/release/featherlight.min.css" type="text/css" rel="stylesheet" />
		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-beta1/jquery.min.js" type="text/javascript" ></script>
		<script src="https://cdn.rawgit.com/noelboss/featherlight/1.4.0/release/featherlight.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="/assets/dist/sweetalert.min.js"></script>
		<link rel="stylesheet" type="text/css" href="/assets/dist/sweetalert.css">
	</head>
	<body>

		<!-- Header -->
			<header id="header">
				<a href="/" class="title">建楓茶會</a>
				<nav>
					<ul>
						<li><a href="/about">About</a></li>
						<li><a href="/registeration" class="active">Registeration</a></li>
						<li><a href="/projects">Projects</a></li>
					</ul>
				</nav>
			</header>

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
                <section id="main" class="wrapper">
                    <div class="inner">
                    <h1>報名</h1>
                    <form method="post" action="#">
                        <div class="row uniform">
                            <div class="6u 12u$(xsmall)">
                                <input type="text" name="demo-name" class="plac" id="name" value="" placeholder="社團名稱" />
                            </div>
                            <div class="6u$ 12u$(xsmall)">
                                <input type="email" name="demo-email" class="plac" id="room" value="" placeholder="房位" />
                            </div>
                            <div class="12u$">
                                <div class="select-wrapper">
                                    <select name="demo-category" id="join">
                                        <option value="-1">參加</option>
                                        <option value="1">楓資茶會</option>
                                        <option value="2">建資茶會</option>
                                        <option value="0">楓資&amp;&amp;建資茶會</option>
                                    </select>
                                </div>
                            </div>

                            <div class="12u$ personappend">
                                <textarea name="demo-message" class="plac" id="ps" placeholder="備註" rows="6"></textarea>
                            </div>
                            <div class="12u$">
                                <ul class="actions">
                                    <li><input type="button" value="Register" class="special" id="regist"/></li>
                                    <li><input type="reset" value="Reset" id="reset"/></li>
                                </ul>
                            </div>
                        </div>
                    </form>
                    </div>
                </section>

			</div>

		<!-- Footer -->
			<footer id="footer" class="wrapper alt">
				<div class="inner">
					<ul class="menu">
						<li>&copy; <a href="http://infor.org/">INFOR</a>. All rights reserved.</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
					</ul>
				</div>
			</footer>

		<!-- Scripts -->
			<script src="../assets/js/jquery.min.js"></script>
			<script src="../assets/js/jquery.scrollex.min.js"></script>
			<script src="../assets/js/jquery.scrolly.min.js"></script>
			<script src="../assets/js/skel.min.js"></script>
			<script src="../assets/js/util.js"></script>
			<!--[if lte IE 8]><script src="../assets/js/ie/respond.min.js"></script><![endif]-->
			<script src="../assets/js/main.js"></script>
	</body>
</html>

<script src="/socket.io/socket.io.js"></script>

<script>
	var socket=io("http://210.71.78.200:80");
    var cnt=0;
    var appe=[];
    $('.personappend').before('<div class="6u"><input type="text" name="demo-message" class="appendname" id="person'+cnt+'" placeholder="姓名" rows="1"></input></div>');
    appe.push(0);

    setInterval(function(){
        if(document.getElementById('person'+cnt).value!=""){
            cnt++;
            $('.personappend').before('<div class="6u"><input type="text" name="demo-message" class="appendname" id="person'+cnt+'" placeholder="姓名" rows="1"></input></div>');
            appe.push(cnt);
        }
        for(i=0;i<appe.length-1;i++){
            if(appe[i]!=undefined&&document.getElementById('person'+appe[i]).value==""&&appe.length>1){
                $('#person'+appe[i]).parent().remove();
                delete appe[i];
            }
        }
    },50)

	window.addEventListener('load',function(){
		document.getElementById('regist').addEventListener('click',function(){
			var name=document.getElementById('name').value;
			var room=document.getElementById('room').value;
			var join=document.getElementById('join').value;

            var able=true;

            var person=[];
            for(i=0;i<appe.length-1;i++){
                if(appe[i]!=undefined){
                    person.push(document.getElementById('person'+appe[i]).value);
                }
            }

            var ps=document.getElementById('ps').value;

			if(join==="-1"){
				join="NO";
			}
			else if(join==="1"){
				join="ZSISC";
			}
			else if(join==="2"){
				join="INFOR";
			}
			else if(join==="0"){
				join="BOTH";
			}
			else{
				join="there's a bug";
			}

            if(name==""||room==""||join=="NO"||person.length==0){
            	able=false;
            }
			if(able){
				socket.emit("sendReg",name,room,join,person,ps);
			}
			else{
				sweetAlert("Oops...","看起來有空格","error");
			}
		})
		document.getElementById('reset').addEventListener('click',function(){
			document.getElementById('name').value="";
			document.getElementById('room').value="";
			document.getElementById('join').value="-1";

            for(i=0;i<appe.length-1;i++){
                document.getElementById('person'+appe[i]).value="";
            }/*
            if press_reset
                then get_ERROR
            working
            */

            document.getElementById('ps').value="";
		})
	})

    socket.on('done',function(){
       swal({   title: "success",  type: "success",   confirmButtonColor: "#8CD4F5",   confirmButtonText: "Back to Home",   closeOnConfirm: false }, function(){   window.location.href = "/" });

})
</script>

<!--
	bugs: human checkbox

-->
